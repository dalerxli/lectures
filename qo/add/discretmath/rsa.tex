%% -*- coding:utf-8 -*- 
\section{Алгоритм RSA}
\label{AddRSA}
\index{алгоритм RSA}
Алгоритм RSA (аббревиатура от фамилий Rivest, Shamir и Adleman) - 
несимметричный алгоритм шифрования
\footnote{Несимметричным (с открытым ключом) называется такой алгоритм
  шифрования, в 
  котором используются два различных ключа: один для шифрования, а
  второй для де-шифрования},  
основанный на сложности разложения числа на простые множители.  

\subsection{Генерация ключей}
\index{алгоритм RSA!генерация ключей}
Состоит из нескольких шагов
\input ./add/discretmath/rsagenalgo.tex

Исходные числа $p$ и $q$ держатся в секрете, потому что с их помощью
можно вычислить закрытый ключ.

\input ./add/discretmath/rsagenex.tex

\subsection{Шифрование}
\index{алгоритм RSA!шифрование}
\input ./add/discretmath/rsaencrypt.tex

\subsection{Де-шифрование}
\index{алгоритм RSA!де шифрование}
\input ./add/discretmath/rsadecrypt.tex

\subsection{Доказательство}
Хотим доказать что 
\[
\left(m^e\right)^d \equiv m \mod{p \cdot q}
\]
для любых положительных числ $m$ когда $p$ и $q$ простые числа, а $e$
и $d$ удовлетворяют выражению
\[
d \cdot e \equiv 1 \mod{\phi\left(p \cdot q\right)},
\]
которое мы можем переписать в виде
\[
d \cdot e - 1 = h \left(p - 1\right)\left(q - 1\right).
\]

Таким образом
\[
m^{e\cdot d} =m m^{h \left(p - 1\right)\left(q - 1\right)}.
\]
Далее возможны два случая: когда $m$ делится на $p$ и когда $m$ и $p$
взаимно просты.

В первом случае 
\[
m^{e\cdot d} \equiv m \equiv 0 \mod{p}
\]
Во втором случае используем
\myref{addDiscretSmallFerma}{малую теорему Ферма}:
\[
m m^{h \left(p - 1\right)\left(q - 1\right)} 
= m \left(m^{p - 1}\right)^{h \left(q - 1\right)} \equiv m \cdot 1^{h
  \left(q - 1\right)} \equiv m \mod{p}.
\]
Аналогично имеем либо
\[
m^{e\cdot d} \equiv m \equiv 0 \mod{q}
\]
либо в силу малой теоремы Ферма
\[
m m^{h \left(p - 1\right)\left(q - 1\right)} 
= m \left(m^{q - 1}\right)^{h \left(p - 1\right)} \equiv m \cdot 1^{h
  \left(p - 1\right)} \equiv m \mod{q}
\]
откуда
\[
m^{e\cdot d} \equiv m \mod{p \cdot q}
\]
