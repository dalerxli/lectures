%% -*- coding:utf-8 -*-
\section{Эллиптическая криптография}

\subsection{Эллиптические кривые над полем $\mathbb{R}$}

\input ./add/discretmath/figelliptic.tex

В эллиптической криптографии рассматривают определенные наборы
объектов которые образуют группу (см. \autoref{sec:add:group}). В
качестве такого набора мы будем рассматривать точки принадлежащие
некоторой кривой (см. \autoref{fig:add:ellipticR}): 
\[
E: y^2 = x^3 +a x + b,
\]
где коэффициенты $a,b$ должны удовлетворять следующему соотношению
\[
4 a^3 + 27 b^2 \ne 0,
\]
в этом случае кубическое уравнение $x^3 + a x + b = 0$ будет иметь 3
различных действительных корня \cite{Washington:2008:ECN:1388394}. 

\input ./add/discretmath/figellipticsum.tex

В соответствии с определением \ref{def:add:group} для точек на кривой 
задана некоторая бинарная операция которая двум точкам $p, q$ с
координатами $(p_x, p_y)$ и $(q_x, q_y)$, соответственно, сопоставляет
третью точку $r$ с 
координатами $(r_x, r_y)$, данную операцию мы будем называть
сложением:
\[
p + q = r.
\]
Существует простая геометрическая интерпретация операции сложения (см.
\autoref{fig:add:ellipticRsum}). Допустим имеется 2 точки на кривой
которые мы хотим сложить: $p$ и $q$ с координатами $(x_p, y_p), (x_q,
y_q)$ соответственно. Если $x_p \ne x_q$, то через эти точки можно
провести прямую, которая имеет наклон 
\[
m = \frac{y_p - y_q}{x_p - x_q}.
\]
и пересекает кривую в точке $r'$. Если эта точка имеет координаты
$(x_{r'}, y_{r'})$, то в силу того, что на лежит на прямой с наклоном $m$:
\[
m = \frac{y_{r'} - y_p}{x_{r'} - x_p},
\]
следовательно
\[
y_{r'} = y_p + m \left(x_{r'} - x_p\right).
\]
Эта точка должна принадлежать кривой, т.е.
\begin{eqnarray}
y_{r'}^2 = \left(y_p + m \left(x_{r'} - x_p\right)\right)^2 = x_{r'}^3
+ a x_{r'} + b
\nonumber
\end{eqnarray}
которое можно переписать
\begin{eqnarray}
x_{r'}^3 - m^2 x_{r'}^2 + \dots = 0.
\nonumber
\end{eqnarray}
Уравнение $x^3 - m^2 x^2 + \dots = 0$ имеет 3 корня: $x_p, x_q,
x_{r'}$, т.е. его можно также переписать в виде
\begin{eqnarray}
(x - x_{r'})(x - x_p)(x - x_q) = x^3 - (x_{r'} + x_p + x_q) x^2 +
  \dots = 0.
\nonumber
\end{eqnarray}
Т.о. 
\[
x_{r'} + x_p + x_q = m^2.
\]
Следовательно
\begin{eqnarray}
x_{r'} = m^2 - x_p - x_q,
\nonumber \\
y_{r'} = y_p + m \left(x_{r'} - x_p\right),
\nonumber
\end{eqnarray}
Отразив эту точку относительно оси $X$ мы получим финальную точку $r$
которую будем называть суммой исходных точек  (см.
\autoref{fig:add:ellipticRsum}). Координаты этой точки $x_r, y_r$
могут быть получены по следующим формулам
\begin{eqnarray}
x_{r} = m^2 - x_p - x_q,
\nonumber \\
y_{r} = - y_p + m \left(x_p - x_r\right).
\label{eq:add:discretmath:elliptic:add}
\end{eqnarray}

\input ./add/discretmath/figellipticsumeq2.tex
\input ./add/discretmath/figellipticsumeq.tex

В случае $x_p = x_q$ возможны два варианта:
\begin{enumerate}
\item $y_p = y_q$ (см. \autoref{fig:add:ellipticRsumEq2})
\item $y_p \ne y_q$ (см. \autoref{fig:add:ellipticRsumEq})
\end{enumerate}



\begin{enumerate}
\item Определена бинарная операция, которую мы будем называть сложением
\item Элемент $e$ будет называться нулем
\item Для каждого элемента есть соответствующий обратный элемент
\end{enumerate}
TBD

\subsection{Эллиптические кривые над полем $\mathbb{F}_p$}
TBD
