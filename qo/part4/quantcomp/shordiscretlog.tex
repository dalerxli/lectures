%% -*- coding:utf-8 -*- 
\section{Квантовое преобразование Фурье и дискретное логарифмирование}
Дискретный логарифм (см. \autoref{AddDiscretLog}) является основой для
большого числа современных криптографических алгоритмов (см.
\autoref{sec:add:dm:elgamal}, \autoref{sec:add:dm:dh}). Вместе с тем 
метод предложеный Шором для факторизации целых чисел может быть также
применен для вычисления дискретных логарифмов, что делает возможным
взлом соотвествующих криптографических алгоритмов.

Поставим задачу следующим образом: имеется выражение 
\[
b = a^x \mod p,
\]
в котором числа $a, b$ и $p$ заданны, а число $x$ является
неизвестным, которое необходимо определить. По аналогии с применением
квантового преобразования Фурье для факторизации чисел (см.
\autoref{sec:part4:algoshor:periodfind}), мы должны
построить некоторую периодическую функцию, период которой даст нам
возможность определить искомое число $x$.

Выберем в качестве анализируемой функции
\begin{equation}
f\left(x_1, x_2\right) = b^{x_1}a^{x_2} = a^{x \cdot x_1} a^{x_2} \mod p
\label{eq:part4:quantcomp:discretlogfunc}
\end{equation}
Функция двух аргументов \eqref{eq:part4:quantcomp:discretlogfunc}
будет периодической, при этом период может быть записан в виде пары
чисел $(t_1, t_2)$ так что
\begin{eqnarray}
f\left(x_1 + t_1, x_2 + t_2\right) = f\left(x_1, x_2\right),
\nonumber
\end{eqnarray}
т. о. 
\[
a^{x \cdot \left( x_1 + t_1 \right) + x_2 + t_2} = a^{x \cdot x_1 + x_2}
\mod p,
\]
т.е. 
\[
a^{x t_1 + t_2} = 1 \mod p.
\]
Далее по \myref{addDiscretSmallFerma}{малой теореме Ферма} 
\begin{equation}
x t_1 + t_2 = 0 \mod (p-1).
\label{eq:part4:quantcomp:discretlogeq}
\end{equation}

\input part4/quantcomp/figquantfourier2d.tex

Для определения периодов функции двух аргументов можно воспользоваться
двумерным преобразованием Фурье, которое может быть построено из
блоков осуществляющих одномерное преобразование Фурье, как это
изображено на \autoref{figQuantCompQuantFourier2d}. Для анализа этой
схемы рассмотрим тривиальный случай когда
на входе имеем (см. также \eqref{eqPart4QuantCompShorQuantFourierSeries})
\begin{eqnarray}
\ket{x} = \ket{x}_1 \otimes \ket{x}_2,
\nonumber \\
\ket{x}_{1,2} = \sum_{k_{1,2} = 0}^{M-1} x_{k_{1,2}}^{(1,2)} \ket{k_{1,2}}.
\nonumber
\end{eqnarray}
С учетом того, что на выходе получается
\[
\ket{\tilde{X}} = \ket{\tilde{X}_1} \otimes \ket{\tilde{X}_2},
\]
где
\[
\ket{\tilde{X}_{1,2}} = \sum_{j_{1,2} = 0}^{M-1} \tilde{X}_{j_{1,2}}^{(1,2)} \ket{j_{1,2}}
\]
и в соответствии с \eqref{eqPart4QuantCompShorQuantFourierEnd}
\[
\tilde{X}_{j_{1,2}}^{(1,2)} = \frac{1}{\sqrt{M}}\sum_{k_{1,2} = 0}^{M - 1}e^{-i \omega_{1,2} k_{1,2} j_{1,2}} x_{k_{1,2}}^{(1,2)}.
\]
получим
\begin{eqnarray}
\ket{\tilde{X}} = \ket{\tilde{X}_1} \otimes \ket{\tilde{X}_2} = 
\nonumber \\
= \sum_{j_1 = 0}^{M-1}\sum_{j_2 = 0}^{M-1}
\tilde{X}_{j_{1}}^{(1)} \tilde{X}_{j_{2}}^{(2)} \ket{j_1} \otimes
\ket{j_2} =
\nonumber \\
= \sum_{j_1 = 0}^{M-1}\sum_{j_2 = 0}^{M-1}
\tilde{X}_{j_{1},j_{2}} \ket{j_1} \otimes
\ket{j_2}, 
\nonumber
\end{eqnarray}
где
\begin{eqnarray}
\tilde{X}_{j_{1},j_{2}} = \frac{1}{\left( \sqrt{M} \right)^2} 
\sum_{k_{1} = 0}^{M - 1}\sum_{k_{2} = 0}^{M - 1}
e^{-i \omega \left( k_{1} j_{1} + k_{2} j_{2}\right)}
x_{k_1}^{(1)}x_{k_2}^{(2)} =
\nonumber \\
= \frac{1}{\left( \sqrt{M} \right)^2}
\sum_{k_{1} = 0}^{M - 1}\sum_{k_{2} = 0}^{M - 1}
e^{-i \omega \left( k_{1} j_{1} + k_{2} j_{2}\right)}
x_{k_1, k_2}
\nonumber
\end{eqnarray}
что, в соответствии с определением \ref{def:add:dsp:fourier2d},
\index{двумерное преобразование Фурье}
является двумерным преобразованием Фурье от исходного двумерного 
сигнала
\[
\ket{x} = 
\sum_{k_1 = 0}^{M-1}\sum_{k_2 = 0}^{M-1}
x_{k_1}^{(1)}x_{k_2}^{(2)} \ket{k_1} \otimes \ket{k_2} =
\sum_{k_1 = 0}^{M-1}\sum_{k_2 = 0}^{M-1}
x_{k_1,k_2} \ket{k_1} \otimes \ket{k_2}.  
\]

\input part4/quantcomp/figquantperiodfinding2.tex

Следовательно используя схему, изображенную на
\autoref{figQuantCompQuantPeriodFinding2} можно определить периоды
$t_1, t_2$ и в дальнейшем используя
\eqref{eq:part4:quantcomp:discretlogeq} определить искомое $x$.


Рассмотрим квантовый аналог решения задачи из прим.
\ref{ex:dm:discretlog}:
\begin{example}
\emph{($ind_3{13} \mod{17}$)}
% maxima
% pts:makelist(makelist([x,y,mod(power_mod(17, 13,
% x)*power_mod(17,3,y),17)], x, 1, 25), y, 1, 25); 
%
% scene:points(pts);
В нашем примере $p = 17$, $b=13$ и $a=3$. Функция
\eqref{eq:part4:quantcomp:discretlogfunc} имеет вид
\[
f\left(x_1, x_2\right) = b^{x_1}a^{x_2} = 13^{x_1}3^{x_2}.
\]
TBD
\label{ex:part4:quantcomp:discretlog:periodfinding}
\end{example}

