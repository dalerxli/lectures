%% -*- coding:utf-8 -*- 
\section{Квантовое преобразование Фурье и дискретное логарифмирование}
Дискретный логарифм (см. \autoref{AddDiscretLog}) является основой для
большого числа современных криптографических алгоритмов (см.
\autoref{sec:add:dm:elgamal}, \autoref{sec:add:dm:dh}). Вместе с тем 
метод предложеный Шором для факторизации целых чисел может быть также
применен для вычисления дискретных логарифмов, что делает возможным
взлом соотвествующих криптографических алгоритмов.

Поставим задачу следующим образом: имеется выражение 
\[
b = a^x \mod p,
\]
в котором числа $a, b$ и $p$ заданны, а число $x$ является
неизвестным, которое необходимо определить. По аналогии с применением
квантового преобразования Фурье для факторизации чисел (см.
\autoref{sec:part4:algoshor:periodfind}), мы должны
построить некоторую периодическую функцию, период которой даст нам
возможность определить искомое число $x$. Выберем в качестве анализируемой функции
\begin{equation}
f\left(x_1, x_2\right) = b^{x_1}a^{x_2} = a^{x \cdot x_1} a^{x_2} \mod p
\label{eq:part4:quantcomp:discretlogfunc}
\end{equation}

В качестве примера мы будем рассматривать квантовый аналог решения задачи из прим.
\ref{ex:dm:discretlog}:
\begin{example}
\emph{($ind_3{14} \mod{17}$)}
% maxima
% pts:makelist(makelist([x,y,mod(power_mod(17, 13,
% x)*power_mod(17,3,y),17)], x, 1, 25), y, 1, 25); 
%
% scene:points(pts);
\input ./part4/quantcomp/figdiscretlog0.tex
В нашем примере $p = 17$, $b=14$ и $a=3$. Функция
\eqref{eq:part4:quantcomp:discretlogfunc} имеет вид
\[
f\left(x_1, x_2\right) = b^{x_1}a^{x_2} = 14^{x_1}3^{x_2}.
\]
и изображена на \autoref{fig:part4:quantcomp:dl0}.

$b=14$, так же как и $a=3$ является генератором
$\left(\mathbb{Z}/17\mathbb{Z}\right)^\times$. При этом $3 \equiv 14^9
\mod 17$. При этом периодами изображенной функции, как это видно из
\autoref{fig:part4:quantcomp:dl0}, будут следующие числа 
\begin{eqnarray}
t_1 \equiv 1 \mod 16,
\nonumber \\
t_2 \equiv 9 \mod 16
\end{eqnarray} 
\label{ex:part4:quantcomp:discretlog:periodfinding0}
\end{example}


В по аналогии с решением задачи факторизации производится измерение
этой функции. Допустим в результате измерения мы получили число $c \in
\left(\mathbb{Z}/p\mathbb{Z}\right)^\times$. В силу того, что $a$
является порождающим элементом (см. опред.
\ref{def:add:algebra:cyclic_group}) мультипликативной группы   
$\left(\mathbb{Z}/p\mathbb{Z}\right)^\times$ (см. опред.
\ref{def:add:algebra:mult_group}) $\exists x_0: c = a^{x_0}$. Т. о. с
учетом \myref{addDiscretSmallFerma}{малой теоремы Ферма} $a^{p-1}
\equiv 1 \mod p$ и следовательно
\[
x_0 \equiv x x_1 + x_2 \mod q,
\] 
где $q = p - 1$.
Из этого выражения следует, что
\[
x_2 \equiv x_0 - x x_1 \mod q.
\]
Т. е. если функция является периодической по первому аргументу:
\[
f(x_1 + t_1, x_2) = f(x_1,x_2),
\]
то она будет периодической по второму аргументу
\[
f(x_1, x_2 + t_2) = f(x_1,x_2),
\]
при этом 
\begin{equation}
t_2 \equiv x t_1 \mod q.
\label{eq:part4:quantcomp:discretlogeq}
\end{equation}

\subsection{Двумерное преобразование Фурье и период функции $f(x_1,
  x_2)$}
Нашей исследуемой функцией будет являться следующая:
\[
f'\left(x_1, x_2\right) = 
\begin{cases}
1, x x_1 + x_2 = x_0 \\
0, x x_1 + x_2 \ne x_0 \\
\end{cases}
\]
\begin{example}
\emph{($ind_3{14} \mod{17}$)}
% maxima
% pts:makelist(makelist([x,y,mod(power_mod(17, 13,
% x)*power_mod(17,3,y),17)], x, 1, 25), y, 1, 25); 
%
% scene:points(pts);

\input ./part4/quantcomp/figdiscretlog1.tex
Продолжая пример \ref{ex:part4:quantcomp:discretlog:periodfinding0}
допустим, что в результате измерения функции $f$ мы получили значение
$f = 3$. В результате для $x_1, x_2$ останутся только те значения,
которые соответствуют наблюдаемому значению функции (см.
\autoref{fig:part4:quantcomp:dl1}), т.е. $x x_1 + x_2 = x_0 = 1$ 
\label{ex:part4:quantcomp:discretlog:periodfinding1}
\end{example}


Прежде всего рассмотрим случай когда число отсчетов преобразования
Фурье кратно $q$. В этом случае для Фурье образа $\tilde{f}$ имеем
\begin{eqnarray}
\tilde{f'}\left(j_1, j_2\right) = 
\frac{1}{q}\sum_{x_1 = 0}^{q-1}
\frac{1}{q}\sum_{x_2 = 0}^{q-1} 
f'\left(x_1, x_2\right)e^{-i \omega\left(x_1 j_1 + x_2j_2\right)} =
\nonumber \\
= \frac{1}{q}\sum_{x_1 = 0, x_2 = x_0 - x x_1}^{q-1}
e^{-i \omega\left(x_1 j_1 + x_2 j_2\right)} = 
 \frac{1}{q}\sum_{x_1 = 0}^{q-1}e^{-i \omega\left(x_1 j_1 + (x_0 - x
   x_1) j_2\right)} = 
\nonumber \\
= e^{-i \omega x_0 j_2}\frac{1}{q}\sum_{x_1 = 0}^{q-1}e^{-i
  \omega x_1 \left(j_1 - x j_2\right)},
\label{eq:part4:quantcomp:discretlog:ftq16}
\end{eqnarray}
где $\omega = \frac{2 \pi}{q}$. В выражении
\eqref{eq:part4:quantcomp:discretlog:ftq16} $\tilde{f}(j_1, j_2) =
e^{-i \omega x_0 j_2} \ne 0$, если $j_1 = x j_2$. 
В противном случае по формуле геометрической прогрессии 
\begin{eqnarray}
\tilde{f'}\left(j_1 \ne x j_2, j_2\right) = 
e^{-i \omega x_0 j_2}\frac{1}{q}\sum_{x_1 = 0}^{q-1}e^{-i
  \omega x_1 \left(j_1 - x j_2\right)} = 
\nonumber \\
=
\frac{e^{-i \omega x_0 j_2}}{q} \frac{e^{-i
  \omega q \left(j_1 - x j_2\right)} - 1}{e^{-i
  \omega \left(j_1 - x j_2\right)} - 1} = 
 \frac{e^{-i \omega x_0 j_2}}{q} 
\frac{e^{-i \frac{2 \pi}{q} q \left(j_1 - x j_2\right)} - 1}{e^{-i
  \omega \left(j_1 - x j_2\right)} - 1} = 0.
\nonumber
\end{eqnarray} 
Т. о. для определения периода нам необходимо найти координаты $(j_1, j_2)$
любого максимума преобразования Фурье и воспользоваться выражением 
\begin{equation}
x = \frac{j_1}{j_2}.
\label{eq:part4:quantcomp:discretlog:periodfourier}
\end{equation}
\begin{example}
\emph{($ind_3{14} \mod{17}$)}
% maxima
% pts:makelist(makelist([x,y,mod(power_mod(17, 13,
% x)*power_mod(17,3,y),17)], x, 1, 25), y, 1, 25); 
%
% scene:points(pts);

\input ./part4/quantcomp/figdiscretlog2.tex

Фурье образ функции с \autoref{fig:part4:quantcomp:dl1} изображен на
\autoref{fig:part4:quantcomp:dl2} из которого видно, что с наибольшей
вероятностью будут регистрироваться отсчеты которые следуют с
интервалом $T_{j_1} = 9$ по координате $j_1$ и с интервалом $T_{j_2} =
1$ по координате $j_2$. С учетом того, что число отсчетов $M=16$ можно
получить координаты максимума преобразования Фурье $j_1 = 9$
и $j_2 = 1$. Решением уравнения $3^x \equiv 14 \mod 17$
является, в соответствии с
\eqref{eq:part4:quantcomp:discretlog:periodfourier}, $x = \frac{9}{1}
= 9$, что соответствует результату прим. 
\ref{ex:dm:discretlog}.

\label{ex:part4:quantcomp:discretlog:periodfinding}
\end{example}


\subsection{Двумерное квантовое преобразование Фурье}

\input part4/quantcomp/figquantfourier2d.tex

Для определения периодов функции двух аргументов можно воспользоваться
двумерным преобразованием Фурье, которое может быть построено из
блоков осуществляющих одномерное преобразование Фурье, как это
изображено на \autoref{figQuantCompQuantFourier2d}. Для анализа этой
схемы рассмотрим тривиальный случай когда
на входе имеем (см. также \eqref{eqPart4QuantCompShorQuantFourierSeries})
\begin{eqnarray}
\ket{x} = \ket{x}_1 \otimes \ket{x}_2,
\nonumber \\
\ket{x}_{1,2} = \sum_{k_{1,2} = 0}^{M-1} x_{k_{1,2}}^{(1,2)} \ket{k_{1,2}}.
\nonumber
\end{eqnarray}
С учетом того, что на выходе получается
\[
\ket{\tilde{X}} = \ket{\tilde{X}_1} \otimes \ket{\tilde{X}_2},
\]
где
\[
\ket{\tilde{X}_{1,2}} = \sum_{j_{1,2} = 0}^{M-1} \tilde{X}_{j_{1,2}}^{(1,2)} \ket{j_{1,2}}
\]
и в соответствии с \eqref{eqPart4QuantCompShorQuantFourierEnd}
\[
\tilde{X}_{j_{1,2}}^{(1,2)} = \frac{1}{\sqrt{M}}\sum_{k_{1,2} = 0}^{M - 1}e^{-i \omega_{1,2} k_{1,2} j_{1,2}} x_{k_{1,2}}^{(1,2)}.
\]
получим
\begin{eqnarray}
\ket{\tilde{X}} = \ket{\tilde{X}_1} \otimes \ket{\tilde{X}_2} = 
\nonumber \\
= \sum_{j_1 = 0}^{M-1}\sum_{j_2 = 0}^{M-1}
\tilde{X}_{j_{1}}^{(1)} \tilde{X}_{j_{2}}^{(2)} \ket{j_1} \otimes
\ket{j_2} =
\nonumber \\
= \sum_{j_1 = 0}^{M-1}\sum_{j_2 = 0}^{M-1}
\tilde{X}_{j_{1},j_{2}} \ket{j_1} \otimes
\ket{j_2}, 
\nonumber
\end{eqnarray}
где
\begin{eqnarray}
\tilde{X}_{j_{1},j_{2}} = \frac{1}{\left( \sqrt{M} \right)^2} 
\sum_{k_{1} = 0}^{M - 1}\sum_{k_{2} = 0}^{M - 1}
e^{-i \omega \left( k_{1} j_{1} + k_{2} j_{2}\right)}
x_{k_1}^{(1)}x_{k_2}^{(2)} =
\nonumber \\
= \frac{1}{\left( \sqrt{M} \right)^2}
\sum_{k_{1} = 0}^{M - 1}\sum_{k_{2} = 0}^{M - 1}
e^{-i \omega \left( k_{1} j_{1} + k_{2} j_{2}\right)}
x_{k_1, k_2}
\nonumber
\end{eqnarray}
что, в соответствии с определением \ref{def:add:dsp:fourier2d},
\index{двумерное преобразование Фурье}
является двумерным преобразованием Фурье от исходного двумерного 
сигнала
\[
\ket{x} = 
\sum_{k_1 = 0}^{M-1}\sum_{k_2 = 0}^{M-1}
x_{k_1}^{(1)}x_{k_2}^{(2)} \ket{k_1} \otimes \ket{k_2} =
\sum_{k_1 = 0}^{M-1}\sum_{k_2 = 0}^{M-1}
x_{k_1,k_2} \ket{k_1} \otimes \ket{k_2}.  
\]

\input part4/quantcomp/figquantperiodfinding2.tex

Следовательно используя схему, изображенную на
\autoref{figQuantCompQuantPeriodFinding2} можно определить периоды
$t_1, t_2$ и в дальнейшем используя
\eqref{eq:part4:quantcomp:discretlogeq} определить искомое $x$.


